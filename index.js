!function(e,t){for(var r in t)e[r]=t[r]}(exports,function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6);t.mapping=n.mapping;var o=r(5);t.map=o.map},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_PROPERTY_SOURCE="default",t.DEFAULT_PROPERTY_SEP=".",t.PROPERTIES_KEY=Symbol("PROPERTIES_KEY"),t.CURRENT_PATH="."},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validAssign=function(e,t){for(var r in e=e||{},t)void 0!==t[r]&&(e[r]=t[r]);return e},t.pushByOrder=function(e,t,r){for(var n=0,o=e.length;n<o;n++){var i=e[n];if(r(t)<r(i))return void e.splice(n,0,t)}return e.push(t)},t.isValid=function(e){return!(null==e||e!=e&&isNaN(e)||e instanceof Date&&isNaN(e.valueOf()))}},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(3),i=[String,Boolean,Number,Date],a=[function(e){return o.isValid(e)?String(e):e},function(e){return Boolean(e)},function(e){return Number(e)},function(e){return o.isValid(e)?new Date(e):e}];function u(e,t,r){if(null==e||"object"!=typeof e)return null;var i=new t;return function(e,t){var r=t&&t.source||n.DEFAULT_PROPERTY_SOURCE,i=e.prototype[n.PROPERTIES_KEY];if(!(i&&r in i))return console.warn("The type "+e.name+" has no mapping annotation declared."),[];var a=i[n.DEFAULT_PROPERTY_SOURCE];if(r!==n.DEFAULT_PROPERTY_SOURCE){if(!1===(t&&t.useDefaultSource)||!Array.isArray(a))return i[r];a=a.slice(),i[r].forEach(function(e){var t=a.findIndex(function(t){return e.name===t.name});~t&&a.splice(t,1),o.pushByOrder(a,e,function(e){return e.order})})}return a}(t,r).forEach(function(t){var n,a,u;try{var f=t.resolvePath(e);u=t.convert(f,e,i,r)}catch(e){console.error(e)}o.isValid(u)?Object.assign(i,((n={})[t.name]=u,n)):"default"in t&&Object.assign(i,((a={})[t.name]=t.default,a))}),i}t.getConverter=function(e){if("function"==typeof e){if(n.PROPERTIES_KEY in e.prototype)return function(t,r,n,o){return u(t,e,o)};var t=i.indexOf(e);return~t?a[t]:e}return function(e){return e}},t.map=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7),o=r(2),i=r(3);t.mapping=function(e){return function(t,r){if("function"!=typeof t){var a=e||{},u=n.Property.from(a,t,r);t[o.PROPERTIES_KEY]=t[o.PROPERTIES_KEY]||{},t[o.PROPERTIES_KEY][u.source]=t[o.PROPERTIES_KEY][u.source]||[],i.pushByOrder(t[o.PROPERTIES_KEY][u.source],u,function(e){return e.order})}else console.warn("Mapping static members is not allowed, it is a dangerous operation.")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),o=r(2),i=r(3),a=function(){function e(){this.separator=o.DEFAULT_PROPERTY_SEP,this.source=o.DEFAULT_PROPERTY_SOURCE,this.order=0}return e.from=function(t,r,n){t="function"==typeof t?{type:t}:t;var o=new e;if(o.name=n,i.validAssign(o,t),t.domain&&(t.path?console.warn("The option domain will be ignored when used with path."):o.path=[t.domain,n].join(o.separator)),o.path=o.path||n,!o.type&&Reflect&&"getMetadata"in Reflect){var a=Reflect.getMetadata("design:type",r,n);o.type=a===Array?[]:a}return o.type?Array.isArray(o.type)&&0===o.type.length&&console.warn("The propery "+n+" missing type declaration and it will treated as any[]"):console.warn("The propery "+n+" missing 'type' option and it will be treated as any, you can import module 'reflect-metadata' to get types automatically"),o},e.prototype.resolvePath=function(e){if(e){if(this.path===o.CURRENT_PATH)return e;for(var t=this.path.split(this.separator),r=0,n=t.length;r<n;r++){var i=t[r],a=i.match(/^(.+)\[(\d)\]$/);if(a){var u=a[1],f=a[2];if(!(Array.isArray(e[u])&&e[u].length>f))break;e=e[u][f]}else{if(!(i in e))break;e=e[i]}}return r===n?e:void 0}},e.prototype.convert=function(e,t,r,o){if(Array.isArray(this.type)){if(!i.isValid(e))return e;var a=n.getConverter(this.type[0]);e=(e=Array.isArray(e)?e:[e]).map(function(e){return a(e,t,r,o)})}else{e=n.getConverter(this.type)(e,t,r,o)}return e},e}();t.Property=a}]));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vaW5kZXgudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbnN0YW50cy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbnZlcnRlci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvYW5ub3RhdGlvbi50cyIsIndlYnBhY2s6Ly8vLi9zcmMvcHJvcGVydHkudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJhbm5vdGF0aW9uXzEiLCJtYXBwaW5nIiwiY29udmVydGVyXzEiLCJtYXAiLCJERUZBVUxUX1BST1BFUlRZX1NPVVJDRSIsIkRFRkFVTFRfUFJPUEVSVFlfU0VQIiwiUFJPUEVSVElFU19LRVkiLCJDVVJSRU5UX1BBVEgiLCJ2YWxpZEFzc2lnbiIsInNvdXJjZSIsImRlc3QiLCJ1bmRlZmluZWQiLCJwdXNoQnlPcmRlciIsImFycmF5IiwiaXRlbSIsInNlbGVjdG9yIiwiaW5kZXgiLCJsZW5ndGhfMSIsImxlbmd0aCIsImVsZW1lbnQiLCJzcGxpY2UiLCJwdXNoIiwiaXNWYWxpZCIsImlzTmFOIiwiRGF0ZSIsInZhbHVlT2YiLCJjb25zdGFudHNfMSIsInV0aWxzXzEiLCJTWVNURU1fVFlQRVMiLCJTdHJpbmciLCJCb29sZWFuIiwiTnVtYmVyIiwiU1lTVEVNX0NPTlZFUlRFUlMiLCJzcmMiLCJjb25zdHVjdG9yIiwib3B0aW9ucyIsImluc3RhbmNlIiwic291cmNlTmFtZSIsInByb3BlcnRpZXMiLCJjb25zb2xlIiwid2FybiIsImRlZmF1bHRQcm9wZXJ0aWVzIiwidXNlRGVmYXVsdFNvdXJjZSIsIkFycmF5IiwiaXNBcnJheSIsInNsaWNlIiwiZm9yRWFjaCIsImZpbmRJbmRleCIsIm9yZGVyIiwiZ2V0UHJvcGVydGllcyIsInJlc3VsdCIsInJlc29sdmVQYXRoIiwiY29udmVydCIsImVycm9yIiwiYXNzaWduIiwiX2EiLCJfYiIsImRlZmF1bHQiLCJnZXRDb252ZXJ0ZXIiLCJ0eXBlIiwiX3NyYyIsIl9kZXN0IiwiaW5kZXhPZiIsInByb3BlcnR5XzEiLCJ0YXJnZXQiLCJvcHRzIiwiUHJvcGVydHkiLCJmcm9tIiwidGhpcyIsInNlcGFyYXRvciIsImRvbWFpbiIsInBhdGgiLCJqb2luIiwiUmVmbGVjdCIsImRlc2lnblR5cGUiLCJnZXRNZXRhZGF0YSIsInBhdGhlcyIsInNwbGl0IiwibWF0Y2hlcyIsIm1hdGNoIiwibmFtZV8xIiwiaW5kZXhfMSIsImNvbnZlcnRfMSJdLCJtYXBwaW5ncyI6IjZEQUNBLElBQUFBLEVBQUEsR0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxHQUFBLENBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsUUFBQSxJQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFGLEdBR0FHLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUEwREEsT0FyREFGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFB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R0FBTUMsT0FJYixDQUNMLEtBQUlWLEtBQVF0QyxHQUdWLE1BRkFBLEVBQU1BLEVBQUlzQyxJQU1oQixPQUFPdkQsSUFBVUUsRUFBU2UsT0FBTXRCLElBR2xDdUQsRUFBQXRFLFVBQUF3RCxRQUFBLFNBQVFuRSxFQUFZZ0QsRUFBVXZCLEVBQVN5QixHQUNyQyxHQUFJUSxNQUFNQyxRQUFRd0IsS0FBS1QsTUFBTyxDQUM1QixJQUFLaEMsRUFBQUwsUUFBUXJDLEdBQVEsT0FBT0EsRUFDNUIsSUFBTWlHLEVBQVVoRixFQUFBd0QsYUFBYVUsS0FBS1QsS0FBSyxJQUV2QzFFLEdBREFBLEVBQVEwRCxNQUFNQyxRQUFRM0QsR0FBU0EsRUFBUSxDQUFDQSxJQUMxQmtCLElBQUksU0FBQ1csR0FBYyxPQUFBb0UsRUFBUXBFLEVBQU1tQixFQUFLdkIsRUFBTXlCLFNBQ3JELENBRUxsRCxFQURnQmlCLEVBQUF3RCxhQUFhVSxLQUFLVCxLQUMxQlAsQ0FBUW5FLEVBQU9nRCxFQUFLdkIsRUFBTXlCLEdBRXBDLE9BQU9sRCxHQUVYaUYsRUF4RUEsR0FBYXBHLEVBQUFvRyIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImltcG9ydCB7IG1hcHBpbmcgfSBmcm9tICcuL3NyYy9hbm5vdGF0aW9uJztcbmltcG9ydCB7IG1hcCB9IGZyb20gJy4vc3JjL2NvbnZlcnRlcic7XG5cbmV4cG9ydCB7IG1hcCwgbWFwcGluZyB9OyIsImV4cG9ydCBjb25zdCBERUZBVUxUX1BST1BFUlRZX1NPVVJDRSA9ICdkZWZhdWx0JztcbmV4cG9ydCBjb25zdCBERUZBVUxUX1BST1BFUlRZX1NFUCA9ICcuJztcbmV4cG9ydCBjb25zdCBQUk9QRVJUSUVTX0tFWSA9IFN5bWJvbCgnUFJPUEVSVElFU19LRVknKTtcbmV4cG9ydCBjb25zdCBDVVJSRU5UX1BBVEggPSAnLic7IiwiZXhwb3J0IGZ1bmN0aW9uIHZhbGlkQXNzaWduKHNvdXJjZTogYW55LCBkZXN0OiBhbnkpIHtcbiAgICBzb3VyY2UgPSBzb3VyY2UgfHwge307XG4gICAgZm9yIChjb25zdCBrZXkgaW4gZGVzdCkge1xuICAgICAgICBpZiAoZGVzdFtrZXldICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHNvdXJjZVtrZXldID0gZGVzdFtrZXldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBzb3VyY2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwdXNoQnlPcmRlcjxUPihhcnJheTogVFtdLCBpdGVtOiBULCBzZWxlY3RvcjogKGl0ZW06IFQpID0+IGFueSkge1xuICAgIGZvciAobGV0IGluZGV4ID0gMCwgbGVuZ3RoID0gYXJyYXkubGVuZ3RoOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gYXJyYXlbaW5kZXhdO1xuICAgICAgICBpZiAoc2VsZWN0b3IoaXRlbSkgPCBzZWxlY3RvcihlbGVtZW50KSkge1xuICAgICAgICAgICAgYXJyYXkuc3BsaWNlKGluZGV4LCAwLCBpdGVtKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYXJyYXkucHVzaChpdGVtKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWQodmFsdWU6IGFueSkge1xuICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gZmFsc2U7XG4gICAgaWYgKHZhbHVlID09PSBudWxsKSByZXR1cm4gZmFsc2U7XG4gICAgaWYgKHZhbHVlICE9PSB2YWx1ZSAmJiBpc05hTih2YWx1ZSkpIHJldHVybiBmYWxzZTtcbiAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBEYXRlICYmIGlzTmFOKHZhbHVlLnZhbHVlT2YoKSkpIHJldHVybiBmYWxzZTtcbiAgICByZXR1cm4gdHJ1ZTtcbn0iLCJpbXBvcnQgeyBQcm9wZXJ0eVR5cGUsIElNYXBwaW5nT3B0aW9ucywgSUNvbnZlcnRlciB9IGZyb20gXCIuL2ludGVyZmFjZVwiO1xuaW1wb3J0IHsgREVGQVVMVF9QUk9QRVJUWV9TT1VSQ0UsIFBST1BFUlRJRVNfS0VZIH0gZnJvbSBcIi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBQcm9wZXJ0eSB9IGZyb20gXCIuL3Byb3BlcnR5XCI7XG5pbXBvcnQgeyBwdXNoQnlPcmRlciwgaXNWYWxpZCB9IGZyb20gXCIuL3V0aWxzXCI7XG5cbmNvbnN0IFNZU1RFTV9UWVBFUzogQXJyYXk8UHJvcGVydHlUeXBlPGFueT4+ID0gW1N0cmluZywgQm9vbGVhbiwgTnVtYmVyLCBEYXRlXTtcblxuY29uc3QgU1lTVEVNX0NPTlZFUlRFUlM6IEFycmF5PElDb252ZXJ0ZXI8YW55Pj4gPSBbXG4gICh2YWx1ZSkgPT4gaXNWYWxpZCh2YWx1ZSkgPyBTdHJpbmcodmFsdWUpIDogdmFsdWUsXG4gICh2YWx1ZSkgPT4gQm9vbGVhbih2YWx1ZSksXG4gICh2YWx1ZSkgPT4gTnVtYmVyKHZhbHVlKSxcbiAgKHZhbHVlKSA9PiBpc1ZhbGlkKHZhbHVlKSA/IG5ldyBEYXRlKHZhbHVlKSA6IHZhbHVlLFxuXTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldENvbnZlcnRlcjxUPih0eXBlPzogUHJvcGVydHlUeXBlPFQ+KTogSUNvbnZlcnRlcjxUPiB7XG4gIGlmICh0eXBlb2YgdHlwZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGlmIChQUk9QRVJUSUVTX0tFWSBpbiB0eXBlLnByb3RvdHlwZSkge1xuICAgICAgcmV0dXJuICh2YWx1ZTogYW55LCBfc3JjOiBhbnksIF9kZXN0OiBULCBvcHRpb25zPzogSU1hcHBpbmdPcHRpb25zKSA9PiBtYXAodmFsdWUsIHR5cGUgYXMgYW55LCBvcHRpb25zKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgaW5kZXggPSBTWVNURU1fVFlQRVMuaW5kZXhPZih0eXBlKTtcbiAgICAgIGlmICh+aW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIFNZU1RFTV9DT05WRVJURVJTW2luZGV4XTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0eXBlIGFzIGFueTtcbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuICh2YWx1ZTogYW55KSA9PiB2YWx1ZTtcbiAgfVxufVxuXG5mdW5jdGlvbiBnZXRQcm9wZXJ0aWVzPFQ+KGNvbnN0dWN0b3I6IGFueSwgb3B0aW9ucz86IElNYXBwaW5nT3B0aW9ucykge1xuICBjb25zdCBzb3VyY2VOYW1lID0gb3B0aW9ucyAmJiBvcHRpb25zLnNvdXJjZSB8fCBERUZBVUxUX1BST1BFUlRZX1NPVVJDRTtcbiAgY29uc3QgcHJvcGVydGllczogUmVjb3JkPHN0cmluZywgQXJyYXk8UHJvcGVydHk8VD4+PiA9IGNvbnN0dWN0b3IucHJvdG90eXBlW1BST1BFUlRJRVNfS0VZXTtcbiAgaWYgKCFwcm9wZXJ0aWVzIHx8ICEoc291cmNlTmFtZSBpbiBwcm9wZXJ0aWVzKSkge1xuICAgIGNvbnNvbGUud2FybihgVGhlIHR5cGUgJHtjb25zdHVjdG9yLm5hbWV9IGhhcyBubyBtYXBwaW5nIGFubm90YXRpb24gZGVjbGFyZWQuYCk7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIGxldCBkZWZhdWx0UHJvcGVydGllcyA9IHByb3BlcnRpZXNbREVGQVVMVF9QUk9QRVJUWV9TT1VSQ0VdO1xuICBpZiAoc291cmNlTmFtZSAhPT0gREVGQVVMVF9QUk9QRVJUWV9TT1VSQ0UpIHtcbiAgICBjb25zdCB1c2VEZWZhdWx0U291cmNlID0gKG9wdGlvbnMgJiYgb3B0aW9ucy51c2VEZWZhdWx0U291cmNlKSAhPT0gZmFsc2U7XG4gICAgaWYgKHVzZURlZmF1bHRTb3VyY2UgJiYgQXJyYXkuaXNBcnJheShkZWZhdWx0UHJvcGVydGllcykpIHtcbiAgICAgIGRlZmF1bHRQcm9wZXJ0aWVzID0gZGVmYXVsdFByb3BlcnRpZXMuc2xpY2UoKTtcbiAgICAgIHByb3BlcnRpZXNbc291cmNlTmFtZV0uZm9yRWFjaChwID0+IHtcbiAgICAgICAgY29uc3QgaW5kZXggPSBkZWZhdWx0UHJvcGVydGllcy5maW5kSW5kZXgobSA9PiBwLm5hbWUgPT09IG0ubmFtZSk7XG4gICAgICAgIH5pbmRleCAmJiBkZWZhdWx0UHJvcGVydGllcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICBwdXNoQnlPcmRlcihkZWZhdWx0UHJvcGVydGllcywgcCwgcCA9PiBwLm9yZGVyKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gcHJvcGVydGllc1tzb3VyY2VOYW1lXTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGRlZmF1bHRQcm9wZXJ0aWVzO1xufVxuXG4vKipcbiAqIE1hcCBhbiBvYmplY3QgdG8gYW4gaW5zdGFuY2Ugb2YgdGhlIHNwZWNpZmllZCB0eXBlLlxuICogQHBhcmFtIHNyYyBEYXRhIHNvdXJjZSBvYmplY3QuXG4gKiBAcGFyYW0gY29uc3R1Y3RvciBUaGUgdHlwZSBvZiBpbnN0YW5jZSwgdGhlIGNvbnN0cnVjdG9yIGZ1bmN0aW9uIG9mIHRoZSBjbGFzcy5cbiAqIEBwYXJhbSBvcHRpb25zIE1hcHBpbmcgb3B0aW9ucy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1hcDxUIGV4dGVuZHMgbmV3ICguLi5hcmdzOiBhbnlbXSkgPT4gYW55PlxuICAoc3JjOiBhbnksIGNvbnN0dWN0b3I6IFQsIG9wdGlvbnM/OiBJTWFwcGluZ09wdGlvbnMpOiBJbnN0YW5jZVR5cGU8VD4gfCBudWxsIHtcbiAgaWYgKHNyYyA9PT0gdW5kZWZpbmVkIHx8IHNyYyA9PT0gbnVsbCB8fCB0eXBlb2Ygc3JjICE9PSAnb2JqZWN0Jykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IGluc3RhbmNlID0gbmV3IGNvbnN0dWN0b3IoKTtcbiAgY29uc3QgcHJvcGVydGllcyA9IGdldFByb3BlcnRpZXMoY29uc3R1Y3Rvciwgb3B0aW9ucyk7XG4gIHByb3BlcnRpZXMuZm9yRWFjaCgocHJvcGVydHkpID0+IHtcbiAgICBsZXQgcmVzdWx0O1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHByb3BlcnR5LnJlc29sdmVQYXRoKHNyYyk7XG4gICAgICByZXN1bHQgPSBwcm9wZXJ0eS5jb252ZXJ0KHZhbHVlLCBzcmMsIGluc3RhbmNlLCBvcHRpb25zKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgfVxuICAgIGlmIChpc1ZhbGlkKHJlc3VsdCkpIHtcbiAgICAgIE9iamVjdC5hc3NpZ24oaW5zdGFuY2UsIHsgW3Byb3BlcnR5Lm5hbWVdOiByZXN1bHQgfSk7XG4gICAgfSBlbHNlIGlmICgnZGVmYXVsdCcgaW4gcHJvcGVydHkpIHtcbiAgICAgIE9iamVjdC5hc3NpZ24oaW5zdGFuY2UsIHsgW3Byb3BlcnR5Lm5hbWVdOiBwcm9wZXJ0eS5kZWZhdWx0IH0pO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBpbnN0YW5jZTtcbn1cbiIsImltcG9ydCB7IElQcm9wZXJ0eSwgSUNvbnZlcnRlciB9IGZyb20gXCIuL2ludGVyZmFjZVwiO1xuaW1wb3J0IHsgUHJvcGVydHkgfSBmcm9tIFwiLi9wcm9wZXJ0eVwiO1xuaW1wb3J0IHsgUFJPUEVSVElFU19LRVkgfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcbmltcG9ydCB7IHB1c2hCeU9yZGVyIH0gZnJvbSAnLi91dGlscyc7XG5cbi8qKlxuICogVGhlIHJlcXVpcmVkIGFubm90YXRpb25zIGZvciBvYmplY3QgbWFwcGluZyB3aGljaCBjYW4gb25seSBiZSB1c2VkIG9uIGluc3RhbmNlIHByb3BlcnRpZXMuXG4gKiBAcGFyYW0gb3B0aW9ucyBtYXBwaW5nIG9wdGlvbnNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1hcHBpbmc8VCA9IGFueT4ob3B0aW9ucz86IElQcm9wZXJ0eTxUPiB8IElDb252ZXJ0ZXI8VD4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldDogYW55LCBuYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0YXJnZXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignTWFwcGluZyBzdGF0aWMgbWVtYmVycyBpcyBub3QgYWxsb3dlZCwgaXQgaXMgYSBkYW5nZXJvdXMgb3BlcmF0aW9uLicpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG9wdHM6IElQcm9wZXJ0eTxUPiA9IG9wdGlvbnMgfHwge30gYXMgYW55O1xuICAgICAgICBjb25zdCBwcm9wZXJ0eSA9IFByb3BlcnR5LmZyb20ob3B0cywgdGFyZ2V0LCBuYW1lKTtcbiAgICAgICAgdGFyZ2V0W1BST1BFUlRJRVNfS0VZXSA9IHRhcmdldFtQUk9QRVJUSUVTX0tFWV0gfHwge307XG4gICAgICAgIHRhcmdldFtQUk9QRVJUSUVTX0tFWV1bcHJvcGVydHkuc291cmNlXSA9IHRhcmdldFtQUk9QRVJUSUVTX0tFWV1bcHJvcGVydHkuc291cmNlXSB8fCBbXTtcbiAgICAgICAgcHVzaEJ5T3JkZXIodGFyZ2V0W1BST1BFUlRJRVNfS0VZXVtwcm9wZXJ0eS5zb3VyY2VdLCBwcm9wZXJ0eSwgaXRlbSA9PiBpdGVtLm9yZGVyKTtcbiAgICB9O1xufVxuIiwiaW1wb3J0IHsgUHJvcGVydHlUeXBlLCBJUHJvcGVydHksIElNYXBwaW5nT3B0aW9ucyB9IGZyb20gJy4vaW50ZXJmYWNlJztcbmltcG9ydCB7IGdldENvbnZlcnRlciB9IGZyb20gJy4vY29udmVydGVyJztcbmltcG9ydCB7IERFRkFVTFRfUFJPUEVSVFlfU09VUkNFLCBERUZBVUxUX1BST1BFUlRZX1NFUCwgQ1VSUkVOVF9QQVRIIH0gZnJvbSAnLi9jb25zdGFudHMnO1xuaW1wb3J0IHsgdmFsaWRBc3NpZ24sIGlzVmFsaWQgfSBmcm9tICcuL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIFByb3BlcnR5PFQ+IGltcGxlbWVudHMgSVByb3BlcnR5PFQ+IHtcbiAgcGF0aDogc3RyaW5nO1xuICB0eXBlOiBQcm9wZXJ0eVR5cGU8VD47XG4gIHNlcGFyYXRvcjogc3RyaW5nID0gREVGQVVMVF9QUk9QRVJUWV9TRVA7XG4gIHNvdXJjZTogc3RyaW5nID0gREVGQVVMVF9QUk9QRVJUWV9TT1VSQ0U7XG4gIGRlZmF1bHQ6IGFueTtcbiAgb3JkZXI6IG51bWJlciA9IDA7XG4gIG5hbWU6IHN0cmluZztcblxuICBzdGF0aWMgZnJvbTxUPihvcHRpb25zOiBJUHJvcGVydHk8VD4sIHRhcmdldDogYW55LCBuYW1lOiBzdHJpbmcpIHtcbiAgICBvcHRpb25zID0gdHlwZW9mIG9wdGlvbnMgPT09ICdmdW5jdGlvbicgPyB7IHR5cGU6IG9wdGlvbnMgfSA6IG9wdGlvbnM7XG4gICAgY29uc3QgcHJvcGVydHkgPSBuZXcgUHJvcGVydHkoKTtcbiAgICBwcm9wZXJ0eS5uYW1lID0gbmFtZTtcbiAgICB2YWxpZEFzc2lnbihwcm9wZXJ0eSwgb3B0aW9ucyk7XG4gICAgaWYgKG9wdGlvbnMuZG9tYWluKSB7XG4gICAgICBpZiAob3B0aW9ucy5wYXRoKSB7XG4gICAgICAgIGNvbnNvbGUud2FybignVGhlIG9wdGlvbiBkb21haW4gd2lsbCBiZSBpZ25vcmVkIHdoZW4gdXNlZCB3aXRoIHBhdGguJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwcm9wZXJ0eS5wYXRoID0gW29wdGlvbnMuZG9tYWluLCBuYW1lXS5qb2luKHByb3BlcnR5LnNlcGFyYXRvcik7XG4gICAgICB9XG4gICAgfVxuICAgIHByb3BlcnR5LnBhdGggPSBwcm9wZXJ0eS5wYXRoIHx8IG5hbWU7XG4gICAgaWYgKCFwcm9wZXJ0eS50eXBlICYmIFJlZmxlY3QgJiYgJ2dldE1ldGFkYXRhJyBpbiBSZWZsZWN0KSB7XG4gICAgICBjb25zdCBkZXNpZ25UeXBlID0gKFJlZmxlY3QgYXMgYW55KS5nZXRNZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIHRhcmdldCwgbmFtZSk7XG4gICAgICBwcm9wZXJ0eS50eXBlID0gZGVzaWduVHlwZSA9PT0gQXJyYXkgPyBbXSA6IGRlc2lnblR5cGU7XG4gICAgfVxuICAgIGlmICghcHJvcGVydHkudHlwZSkge1xuICAgICAgY29uc29sZS53YXJuKGBUaGUgcHJvcGVyeSAke25hbWV9IG1pc3NpbmcgJ3R5cGUnIG9wdGlvbiBhbmQgaXQgd2lsbCBiZSB0cmVhdGVkIGFzIGFueSwgYCArXG4gICAgICAgIGB5b3UgY2FuIGltcG9ydCBtb2R1bGUgJ3JlZmxlY3QtbWV0YWRhdGEnIHRvIGdldCB0eXBlcyBhdXRvbWF0aWNhbGx5YCk7XG4gICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHByb3BlcnR5LnR5cGUpICYmIHByb3BlcnR5LnR5cGUubGVuZ3RoID09PSAwKSB7XG4gICAgICBjb25zb2xlLndhcm4oYFRoZSBwcm9wZXJ5ICR7bmFtZX0gbWlzc2luZyB0eXBlIGRlY2xhcmF0aW9uIGFuZCBpdCB3aWxsIHRyZWF0ZWQgYXMgYW55W11gKTtcbiAgICB9XG4gICAgcmV0dXJuIHByb3BlcnR5O1xuICB9XG5cbiAgcmVzb2x2ZVBhdGgoc3JjOiBhbnkpIHtcbiAgICBpZiAoIXNyYykgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICBpZiAodGhpcy5wYXRoID09PSBDVVJSRU5UX1BBVEgpIHJldHVybiBzcmM7XG4gICAgY29uc3QgcGF0aGVzID0gdGhpcy5wYXRoLnNwbGl0KHRoaXMuc2VwYXJhdG9yKTtcbiAgICBmb3IgKHZhciBpbmRleCA9IDAsIGxlbmd0aCA9IHBhdGhlcy5sZW5ndGg7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICBjb25zdCBwYXRoID0gcGF0aGVzW2luZGV4XTtcbiAgICAgIGNvbnN0IG1hdGNoZXMgPSBwYXRoLm1hdGNoKC9eKC4rKVxcWyhcXGQpXFxdJC8pO1xuICAgICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgICAgY29uc3QgWywgbmFtZSwgaW5kZXhdID0gbWF0Y2hlcztcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoc3JjW25hbWVdKSAmJiBzcmNbbmFtZV0ubGVuZ3RoID4gaW5kZXgpIHtcbiAgICAgICAgICBzcmMgPSBzcmNbbmFtZV1baW5kZXhdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAocGF0aCBpbiBzcmMpIHtcbiAgICAgICAgICBzcmMgPSBzcmNbcGF0aF07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGluZGV4ID09PSBsZW5ndGggPyBzcmMgOiB1bmRlZmluZWQ7XG4gIH1cblxuICBjb252ZXJ0KHZhbHVlOiBhbnksIHNyYzogYW55LCBkZXN0OiBULCBvcHRpb25zPzogSU1hcHBpbmdPcHRpb25zKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkodGhpcy50eXBlKSkge1xuICAgICAgaWYgKCFpc1ZhbGlkKHZhbHVlKSkgcmV0dXJuIHZhbHVlO1xuICAgICAgY29uc3QgY29udmVydCA9IGdldENvbnZlcnRlcih0aGlzLnR5cGVbMF0pO1xuICAgICAgdmFsdWUgPSBBcnJheS5pc0FycmF5KHZhbHVlKSA/IHZhbHVlIDogW3ZhbHVlXTtcbiAgICAgIHZhbHVlID0gdmFsdWUubWFwKChpdGVtOiBhbnkpID0+IGNvbnZlcnQoaXRlbSwgc3JjLCBkZXN0LCBvcHRpb25zKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGNvbnZlcnQgPSBnZXRDb252ZXJ0ZXIodGhpcy50eXBlKTtcbiAgICAgIHZhbHVlID0gY29udmVydCh2YWx1ZSwgc3JjLCBkZXN0LCBvcHRpb25zKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9