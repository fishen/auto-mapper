!function(e,t){for(var r in t)e[r]=t[r]}(exports,function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_PROPERTY_SOURCE="default",t.DEFAULT_PROPERTY_SEP=".",t.PROPERTIES_KEY=Symbol("PROPERTIES_KEY")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=[String,Boolean,Number,Date],i=[function(e){return e&&String(e)},function(e){return Boolean(e)},function(e){return Number(e)},function(e){return e&&new Date(e)}];function a(e,t,r){if(null==e||"object"!=typeof e)return null;var o=r&&r.source||n.DEFAULT_PROPERTY_SOURCE,i=new t,a=t.prototype[n.PROPERTIES_KEY];return a&&o in a?(a[o].forEach(function(t){var n,o,a;try{var u=t.resolvePath(e);a=t.convert(u,e,i,r)}catch(e){console.error(e)}void 0!==a?Object.assign(i,((n={})[t.name]=a,n)):t.default&&Object.assign(i,((o={})[t.name]=t.default,o))}),i):(console.warn("The type "+t.name+" has no mapping annotation declared."),i)}t.getConverter=function(e){if("function"==typeof e){if(n.PROPERTIES_KEY in e.prototype)return function(t,r,n,o){return a(t,e,o)};var t=o.indexOf(e);return~t?i[t]:e}return function(e){return e}},t.map=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validAssign=function(e,t){for(var r in e=e||{},t)void 0!==t[r]&&(e[r]=t[r]);return e},t.pushByOrder=function(e,t,r){for(var n=0,o=e.length;n<o;n++){var i=e[n];if(r(t)<r(i))return void e.splice(n,0,t)}return e.push(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4);t.mapping=n.mapping;var o=r(1);t.map=o.map},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),o=r(0),i=r(2);t.mapping=function(e){return function(t,r){if("function"!=typeof t){var a=e||{},u=n.Property.from(a,t,r);t[o.PROPERTIES_KEY]=t[o.PROPERTIES_KEY]||{},t[o.PROPERTIES_KEY][u.source]=t[o.PROPERTIES_KEY][u.source]||[],i.pushByOrder(t[o.PROPERTIES_KEY][u.source],u,function(e){return e.order})}else console.warn("Mapping static members is not allowed, it is a dangerous operation.")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(2),a=function(){function e(){this.separator=o.DEFAULT_PROPERTY_SEP,this.source=o.DEFAULT_PROPERTY_SOURCE,this.order=0}return e.from=function(t,r,n){t="function"==typeof t?{type:t}:t;var o=new e;if(o.name=n,i.validAssign(o,t),o.path=o.path||n,!o.type&&Reflect&&"getMetadata"in Reflect){var a=Reflect.getMetadata("design:type",r,n);o.type=a===Array?[]:a}return o.type?Array.isArray(o.type)&&0===o.type.length&&console.warn("The propery "+n+" missing type declaration and it will treated as any[]"):console.warn("The propery "+n+" missing 'type' option and it will be treated as any, you can import module 'reflect-metadata' to get types automatically"),o},e.prototype.resolvePath=function(e){if(e){for(var t=this.path.split(this.separator),r=0,n=t.length;r<n;r++){var o=t[r],i=o.match(/^(.+)\[(\d)\]$/);if(i){var a=i[1],u=i[2];if(!(Array.isArray(e[a])&&e[a].length>u))break;e=e[a][u]}else{if(!(o in e))break;e=e[o]}}return r===n?e:void 0}},e.prototype.convert=function(e,t,r,o){if(Array.isArray(this.type)){if(void 0===e)return e;var i=n.getConverter(this.type[0]);e=(e=Array.isArray(e)?e:[e]).map(function(e){return i(e,t,r,o)})}else{e=n.getConverter(this.type)(e,t,r,o)}return e},e}();t.Property=a}]));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbnN0YW50cy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvY29udmVydGVyLnRzIiwid2VicGFjazovLy8uL3NyYy91dGlscy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2Fubm90YXRpb24udHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3Byb3BlcnR5LnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiREVGQVVMVF9QUk9QRVJUWV9TT1VSQ0UiLCJERUZBVUxUX1BST1BFUlRZX1NFUCIsIlBST1BFUlRJRVNfS0VZIiwiY29uc3RhbnRzXzEiLCJTWVNURU1fVFlQRVMiLCJTdHJpbmciLCJCb29sZWFuIiwiTnVtYmVyIiwiRGF0ZSIsIlNZU1RFTV9DT05WRVJURVJTIiwibWFwIiwic3JjIiwiY29uc3R1Y3RvciIsIm9wdGlvbnMiLCJzb3VyY2VOYW1lIiwic291cmNlIiwiaW5zdGFuY2UiLCJwcm9wZXJ0aWVzIiwiZm9yRWFjaCIsInJlc3VsdCIsInJlc29sdmVQYXRoIiwiY29udmVydCIsImVycm9yIiwiY29uc29sZSIsInVuZGVmaW5lZCIsImFzc2lnbiIsIl9hIiwiZGVmYXVsdCIsIl9iIiwid2FybiIsImdldENvbnZlcnRlciIsInR5cGUiLCJfc3JjIiwiX2Rlc3QiLCJpbmRleCIsImluZGV4T2YiLCJ2YWxpZEFzc2lnbiIsImRlc3QiLCJwdXNoQnlPcmRlciIsImFycmF5IiwiaXRlbSIsInNlbGVjdG9yIiwibGVuZ3RoXzEiLCJsZW5ndGgiLCJlbGVtZW50Iiwic3BsaWNlIiwicHVzaCIsImFubm90YXRpb25fMSIsIm1hcHBpbmciLCJjb252ZXJ0ZXJfMSIsInByb3BlcnR5XzEiLCJ1dGlsc18xIiwidGFyZ2V0Iiwib3B0cyIsIlByb3BlcnR5IiwiZnJvbSIsIm9yZGVyIiwidGhpcyIsInNlcGFyYXRvciIsInBhdGgiLCJSZWZsZWN0IiwiZGVzaWduVHlwZSIsImdldE1ldGFkYXRhIiwiQXJyYXkiLCJpc0FycmF5IiwicGF0aGVzIiwic3BsaXQiLCJtYXRjaGVzIiwibWF0Y2giLCJuYW1lXzEiLCJpbmRleF8xIiwiY29udmVydF8xIl0sIm1hcHBpbmdzIjoiNkRBQ0EsSUFBQUEsRUFBQSxHQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLEdBQUEsQ0FDQUcsRUFBQUgsRUFDQUksR0FBQSxFQUNBSCxRQUFBLElBVUEsT0FOQUksRUFBQUwsR0FBQU0sS0FBQUosRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUYsR0FHQUcsRUFBQUUsR0FBQSxFQUdBRixFQUFBRCxRQTBEQSxPQXJEQUYsRUFBQVEsRUFBQUYsRUFHQU4sRUFBQVMsRUFBQVYsRUFHQUMsRUFBQVUsRUFBQSxTQUFBUixFQUFBUyxFQUFBQyxHQUNBWixFQUFBYSxFQUFBWCxFQUFBUyxJQUNBRyxPQUFBQyxlQUFBYixFQUFBUyxFQUFBLENBQTBDSyxZQUFBLEVBQUFDLElBQUFMLEtBSzFDWixFQUFBa0IsRUFBQSxTQUFBaEIsR0FDQSxvQkFBQWlCLGVBQUFDLGFBQ0FOLE9BQUFDLGVBQUFiLEVBQUFpQixPQUFBQyxZQUFBLENBQXdEQyxNQUFB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QSxFQUFJMEQsR0FBTUMsT0FJakIsQ0FDSCxLQUFJWCxLQUFRaEQsR0FHUixNQUZBQSxFQUFNQSxFQUFJZ0QsSUFNdEIsT0FBT3pCLElBQVVTLEVBQVNoQyxPQUFNYSxJQUdwQzhCLEVBQUExRCxVQUFBeUIsUUFBQSxTQUFRcEMsRUFBWTBCLEVBQVUwQixFQUFTeEIsR0FDbkMsR0FBSWtELE1BQU1DLFFBQVFQLEtBQUsxQixNQUFPLENBQzFCLFFBQWNQLElBQVZ2QyxFQUFxQixPQUFPQSxFQUNoQyxJQUFNc0YsRUFBVXRCLEVBQUFuQixhQUFhMkIsS0FBSzFCLEtBQUssSUFFdkM5QyxHQURBQSxFQUFROEUsTUFBTUMsUUFBUS9FLEdBQVNBLEVBQVEsQ0FBQ0EsSUFDMUJ5QixJQUFJLFNBQUM4QixHQUFjLE9BQUErQixFQUFRL0IsRUFBTTdCLEVBQUswQixFQUFNeEIsU0FDdkQsQ0FFSDVCLEVBRGdCZ0UsRUFBQW5CLGFBQWEyQixLQUFLMUIsS0FDMUJWLENBQVFwQyxFQUFPMEIsRUFBSzBCLEVBQU14QixHQUV0QyxPQUFPNUIsR0FFZnFFLEVBL0RBLEdBQWF4RixFQUFBd0YiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMyk7XG4iLCJleHBvcnQgY29uc3QgREVGQVVMVF9QUk9QRVJUWV9TT1VSQ0UgPSAnZGVmYXVsdCc7XG5leHBvcnQgY29uc3QgREVGQVVMVF9QUk9QRVJUWV9TRVAgPSAnLic7XG5leHBvcnQgY29uc3QgUFJPUEVSVElFU19LRVkgPSBTeW1ib2woJ1BST1BFUlRJRVNfS0VZJyk7IiwiaW1wb3J0IHsgUHJvcGVydHlUeXBlLCBJTWFwcGluZ09wdGlvbnMsIElDb252ZXJ0ZXIgfSBmcm9tIFwiLi9pbnRlcmZhY2VcIjtcbmltcG9ydCB7IERFRkFVTFRfUFJPUEVSVFlfU09VUkNFLCBQUk9QRVJUSUVTX0tFWSB9IGZyb20gXCIuL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgUHJvcGVydHkgfSBmcm9tIFwiLi9wcm9wZXJ0eVwiO1xuXG5jb25zdCBTWVNURU1fVFlQRVM6IEFycmF5PFByb3BlcnR5VHlwZTxhbnk+PiA9IFtTdHJpbmcsIEJvb2xlYW4sIE51bWJlciwgRGF0ZV07XG5cbmNvbnN0IFNZU1RFTV9DT05WRVJURVJTOiBBcnJheTxJQ29udmVydGVyPGFueT4+ID0gW1xuICAgICh2YWx1ZSkgPT4gdmFsdWUgJiYgU3RyaW5nKHZhbHVlKSxcbiAgICAodmFsdWUpID0+IEJvb2xlYW4odmFsdWUpLFxuICAgICh2YWx1ZSkgPT4gTnVtYmVyKHZhbHVlKSxcbiAgICAodmFsdWUpID0+IHZhbHVlICYmIG5ldyBEYXRlKHZhbHVlKVxuXVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29udmVydGVyPFQ+KHR5cGU/OiBQcm9wZXJ0eVR5cGU8VD4pOiBJQ29udmVydGVyPFQ+IHtcbiAgICBpZiAodHlwZW9mIHR5cGUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgaWYgKFBST1BFUlRJRVNfS0VZIGluIHR5cGUucHJvdG90eXBlKSB7XG4gICAgICAgICAgICByZXR1cm4gKHZhbHVlOiBhbnksIF9zcmM6IGFueSwgX2Rlc3Q6IFQsIG9wdGlvbnM/OiBJTWFwcGluZ09wdGlvbnMpID0+IG1hcCh2YWx1ZSwgdHlwZSBhcyBhbnksIG9wdGlvbnMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBTWVNURU1fVFlQRVMuaW5kZXhPZih0eXBlKTtcbiAgICAgICAgICAgIGlmICh+aW5kZXgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gU1lTVEVNX0NPTlZFUlRFUlNbaW5kZXhdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZSBhcyBhbnk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gKHZhbHVlOiBhbnkpID0+IHZhbHVlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBNYXAgYW4gb2JqZWN0IHRvIGFuIGluc3RhbmNlIG9mIHRoZSBzcGVjaWZpZWQgdHlwZS5cbiAqIEBwYXJhbSBzcmMgRGF0YSBzb3VyY2Ugb2JqZWN0LlxuICogQHBhcmFtIGNvbnN0dWN0b3IgVGhlIHR5cGUgb2YgaW5zdGFuY2UsIHRoZSBjb25zdHJ1Y3RvciBmdW5jdGlvbiBvZiB0aGUgY2xhc3MuXG4gKiBAcGFyYW0gb3B0aW9ucyBNYXBwaW5nIG9wdGlvbnMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtYXA8VCBleHRlbmRzIG5ldyAoLi4uYXJnczogYW55W10pID0+IGFueT4oc3JjOiBhbnksIGNvbnN0dWN0b3I6IFQsIG9wdGlvbnM/OiBJTWFwcGluZ09wdGlvbnMpOiBJbnN0YW5jZVR5cGU8VD4gfCBudWxsIHtcbiAgICBpZiAoc3JjID09PSB1bmRlZmluZWQgfHwgc3JjID09PSBudWxsIHx8IHR5cGVvZiBzcmMgIT09ICdvYmplY3QnKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCBzb3VyY2VOYW1lID0gKG9wdGlvbnMgJiYgb3B0aW9ucy5zb3VyY2UpIHx8IERFRkFVTFRfUFJPUEVSVFlfU09VUkNFO1xuICAgIGNvbnN0IGluc3RhbmNlID0gbmV3IGNvbnN0dWN0b3IoKTtcbiAgICBjb25zdCBwcm9wZXJ0aWVzOiBSZWNvcmQ8c3RyaW5nLCBQcm9wZXJ0eTxUPltdPiA9IGNvbnN0dWN0b3IucHJvdG90eXBlW1BST1BFUlRJRVNfS0VZXTtcbiAgICBpZiAoIXByb3BlcnRpZXMgfHwgIShzb3VyY2VOYW1lIGluIHByb3BlcnRpZXMpKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihgVGhlIHR5cGUgJHtjb25zdHVjdG9yLm5hbWV9IGhhcyBubyBtYXBwaW5nIGFubm90YXRpb24gZGVjbGFyZWQuYCk7XG4gICAgICAgIHJldHVybiBpbnN0YW5jZTtcbiAgICB9XG4gICAgcHJvcGVydGllc1tzb3VyY2VOYW1lXS5mb3JFYWNoKChwcm9wZXJ0eSkgPT4ge1xuICAgICAgICBsZXQgcmVzdWx0O1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBwcm9wZXJ0eS5yZXNvbHZlUGF0aChzcmMpO1xuICAgICAgICAgICAgcmVzdWx0ID0gcHJvcGVydHkuY29udmVydCh2YWx1ZSwgc3JjLCBpbnN0YW5jZSwgb3B0aW9ucyk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzdWx0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oaW5zdGFuY2UsIHsgW3Byb3BlcnR5Lm5hbWVdOiByZXN1bHQgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAocHJvcGVydHkuZGVmYXVsdCkge1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihpbnN0YW5jZSwgeyBbcHJvcGVydHkubmFtZV06IHByb3BlcnR5LmRlZmF1bHQgfSk7XG4gICAgICAgIH1cbiAgICB9KVxuICAgIHJldHVybiBpbnN0YW5jZTtcbn1cbiIsImV4cG9ydCBmdW5jdGlvbiB2YWxpZEFzc2lnbihzb3VyY2U6IGFueSwgZGVzdDogYW55KSB7XG4gICAgc291cmNlID0gc291cmNlIHx8IHt9O1xuICAgIGZvciAoY29uc3Qga2V5IGluIGRlc3QpIHtcbiAgICAgICAgaWYgKGRlc3Rba2V5XSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzb3VyY2Vba2V5XSA9IGRlc3Rba2V5XVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBzb3VyY2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwdXNoQnlPcmRlcjxUPihhcnJheTogVFtdLCBpdGVtOiBULCBzZWxlY3RvcjogKGl0ZW06IFQpID0+IGFueSkge1xuICAgIGZvciAobGV0IGluZGV4ID0gMCwgbGVuZ3RoID0gYXJyYXkubGVuZ3RoOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gYXJyYXlbaW5kZXhdO1xuICAgICAgICBpZiAoc2VsZWN0b3IoaXRlbSkgPCBzZWxlY3RvcihlbGVtZW50KSkge1xuICAgICAgICAgICAgYXJyYXkuc3BsaWNlKGluZGV4LCAwLCBpdGVtKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYXJyYXkucHVzaChpdGVtKTtcbn0iLCJpbXBvcnQgeyBtYXBwaW5nIH0gZnJvbSAnLi9hbm5vdGF0aW9uJztcbmltcG9ydCB7IG1hcCB9IGZyb20gJy4vY29udmVydGVyJztcblxuZXhwb3J0IHsgbWFwLCBtYXBwaW5nIH07IiwiaW1wb3J0IHsgSVByb3BlcnR5LCBJQ29udmVydGVyIH0gZnJvbSBcIi4vaW50ZXJmYWNlXCI7XG5pbXBvcnQgeyBQcm9wZXJ0eSB9IGZyb20gXCIuL3Byb3BlcnR5XCI7XG5pbXBvcnQgeyBQUk9QRVJUSUVTX0tFWSB9IGZyb20gXCIuL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgcHVzaEJ5T3JkZXIgfSBmcm9tICcuL3V0aWxzJztcblxuLyoqXG4gKiBUaGUgcmVxdWlyZWQgYW5ub3RhdGlvbnMgZm9yIG9iamVjdCBtYXBwaW5nIHdoaWNoIGNhbiBvbmx5IGJlIHVzZWQgb24gaW5zdGFuY2UgcHJvcGVydGllcy5cbiAqIEBwYXJhbSBvcHRpb25zIG1hcHBpbmcgb3B0aW9uc1xuICovXG5leHBvcnQgZnVuY3Rpb24gbWFwcGluZzxUPWFueT4ob3B0aW9ucz86IElQcm9wZXJ0eTxUPiB8IElDb252ZXJ0ZXI8VD4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldDogYW55LCBuYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0YXJnZXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignTWFwcGluZyBzdGF0aWMgbWVtYmVycyBpcyBub3QgYWxsb3dlZCwgaXQgaXMgYSBkYW5nZXJvdXMgb3BlcmF0aW9uLicpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG9wdHM6IElQcm9wZXJ0eTxUPiA9IG9wdGlvbnMgfHwge30gYXMgYW55O1xuICAgICAgICBjb25zdCBwcm9wZXJ0eSA9IFByb3BlcnR5LmZyb20ob3B0cywgdGFyZ2V0LCBuYW1lKTtcbiAgICAgICAgdGFyZ2V0W1BST1BFUlRJRVNfS0VZXSA9IHRhcmdldFtQUk9QRVJUSUVTX0tFWV0gfHwge307XG4gICAgICAgIHRhcmdldFtQUk9QRVJUSUVTX0tFWV1bcHJvcGVydHkuc291cmNlXSA9IHRhcmdldFtQUk9QRVJUSUVTX0tFWV1bcHJvcGVydHkuc291cmNlXSB8fCBbXTtcbiAgICAgICAgcHVzaEJ5T3JkZXIodGFyZ2V0W1BST1BFUlRJRVNfS0VZXVtwcm9wZXJ0eS5zb3VyY2VdLCBwcm9wZXJ0eSwgaXRlbSA9PiBpdGVtLm9yZGVyKVxuICAgIH1cbn0iLCJpbXBvcnQgeyBQcm9wZXJ0eVR5cGUsIElQcm9wZXJ0eSwgSU1hcHBpbmdPcHRpb25zIH0gZnJvbSAnLi9pbnRlcmZhY2UnO1xuaW1wb3J0IHsgZ2V0Q29udmVydGVyIH0gZnJvbSAnLi9jb252ZXJ0ZXInO1xuaW1wb3J0IHsgREVGQVVMVF9QUk9QRVJUWV9TT1VSQ0UsIERFRkFVTFRfUFJPUEVSVFlfU0VQIH0gZnJvbSAnLi9jb25zdGFudHMnO1xuaW1wb3J0IHsgdmFsaWRBc3NpZ24gfSBmcm9tICcuL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIFByb3BlcnR5PFQ+IGltcGxlbWVudHMgSVByb3BlcnR5PFQ+IHtcbiAgICBwYXRoOiBzdHJpbmc7XG4gICAgdHlwZTogUHJvcGVydHlUeXBlPFQ+O1xuICAgIHNlcGFyYXRvcjogc3RyaW5nID0gREVGQVVMVF9QUk9QRVJUWV9TRVA7XG4gICAgc291cmNlOiBzdHJpbmcgPSBERUZBVUxUX1BST1BFUlRZX1NPVVJDRTtcbiAgICBkZWZhdWx0OiBhbnk7XG4gICAgb3JkZXI6IG51bWJlciA9IDA7XG4gICAgbmFtZTogc3RyaW5nO1xuXG4gICAgc3RhdGljIGZyb208VD4ob3B0aW9uczogSVByb3BlcnR5PFQ+LCB0YXJnZXQ6IGFueSwgbmFtZTogc3RyaW5nKSB7XG4gICAgICAgIG9wdGlvbnMgPSB0eXBlb2Ygb3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJyA/IHsgdHlwZTogb3B0aW9ucyB9IDogb3B0aW9ucztcbiAgICAgICAgY29uc3QgcHJvcGVydHkgPSBuZXcgUHJvcGVydHkoKTtcbiAgICAgICAgcHJvcGVydHkubmFtZSA9IG5hbWU7XG4gICAgICAgIHZhbGlkQXNzaWduKHByb3BlcnR5LCBvcHRpb25zKTtcbiAgICAgICAgcHJvcGVydHkucGF0aCA9IHByb3BlcnR5LnBhdGggfHwgbmFtZTtcbiAgICAgICAgaWYgKCFwcm9wZXJ0eS50eXBlICYmIFJlZmxlY3QgJiYgJ2dldE1ldGFkYXRhJyBpbiBSZWZsZWN0KSB7XG4gICAgICAgICAgICBjb25zdCBkZXNpZ25UeXBlID0gKFJlZmxlY3QgYXMgYW55KS5nZXRNZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIHRhcmdldCwgbmFtZSk7XG4gICAgICAgICAgICBwcm9wZXJ0eS50eXBlID0gZGVzaWduVHlwZSA9PT0gQXJyYXkgPyBbXSA6IGRlc2lnblR5cGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFwcm9wZXJ0eS50eXBlKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYFRoZSBwcm9wZXJ5ICR7bmFtZX0gbWlzc2luZyAndHlwZScgb3B0aW9uIGFuZCBpdCB3aWxsIGJlIHRyZWF0ZWQgYXMgYW55LCB5b3UgY2FuIGltcG9ydCBtb2R1bGUgJ3JlZmxlY3QtbWV0YWRhdGEnIHRvIGdldCB0eXBlcyBhdXRvbWF0aWNhbGx5YCk7XG4gICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShwcm9wZXJ0eS50eXBlKSAmJiBwcm9wZXJ0eS50eXBlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKGBUaGUgcHJvcGVyeSAke25hbWV9IG1pc3NpbmcgdHlwZSBkZWNsYXJhdGlvbiBhbmQgaXQgd2lsbCB0cmVhdGVkIGFzIGFueVtdYCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb3BlcnR5O1xuICAgIH1cblxuICAgIHJlc29sdmVQYXRoKHNyYzogYW55KSB7XG4gICAgICAgIGlmICghc3JjKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICBjb25zdCBwYXRoZXMgPSB0aGlzLnBhdGguc3BsaXQodGhpcy5zZXBhcmF0b3IpO1xuICAgICAgICBmb3IgKHZhciBpbmRleCA9IDAsIGxlbmd0aCA9IHBhdGhlcy5sZW5ndGg7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgICBjb25zdCBwYXRoID0gcGF0aGVzW2luZGV4XTtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoZXMgPSBwYXRoLm1hdGNoKC9eKC4rKVxcWyhcXGQpXFxdJC8pO1xuICAgICAgICAgICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBbLCBuYW1lLCBpbmRleF0gPSBtYXRjaGVzO1xuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHNyY1tuYW1lXSkgJiYgc3JjW25hbWVdLmxlbmd0aCA+IGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIHNyYyA9IHNyY1tuYW1lXVtpbmRleF07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAocGF0aCBpbiBzcmMpIHtcbiAgICAgICAgICAgICAgICAgICAgc3JjID0gc3JjW3BhdGhdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5kZXggPT09IGxlbmd0aCA/IHNyYyA6IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBjb252ZXJ0KHZhbHVlOiBhbnksIHNyYzogYW55LCBkZXN0OiBULCBvcHRpb25zPzogSU1hcHBpbmdPcHRpb25zKSB7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRoaXMudHlwZSkpIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgICBjb25zdCBjb252ZXJ0ID0gZ2V0Q29udmVydGVyKHRoaXMudHlwZVswXSk7XG4gICAgICAgICAgICB2YWx1ZSA9IEFycmF5LmlzQXJyYXkodmFsdWUpID8gdmFsdWUgOiBbdmFsdWVdO1xuICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5tYXAoKGl0ZW06IGFueSkgPT4gY29udmVydChpdGVtLCBzcmMsIGRlc3QsIG9wdGlvbnMpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnQgPSBnZXRDb252ZXJ0ZXIodGhpcy50eXBlKTtcbiAgICAgICAgICAgIHZhbHVlID0gY29udmVydCh2YWx1ZSwgc3JjLCBkZXN0LCBvcHRpb25zKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxufSJdLCJzb3VyY2VSb290IjoiIn0=